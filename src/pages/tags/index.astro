---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import type { BlogType } from "../../content.config";

const blogs: BlogType[] = await getCollection("blogs");

// Calculate frequency of each tag
const tagCounts = blogs.reduce(
  (acc, blog) => {
    blog.data.tags.forEach((tag: string) => {
      acc[tag] = (acc[tag] || 0) + 1;
    });
    return acc;
  },
  {} as Record<string, number>,
);

const tags = Object.keys(tagCounts).sort();
---

<BaseLayout
  title="分类标签"
  description="All unique tags of Jarodise blogs"
  author="Jarod"
  url="https://jarodise.com/tags/"
>
  <div class="center px-4">
    <h1 class="heading text-center">分类标签</h1>
    <div class="mt-8 flex flex-wrap justify-center gap-4">
      {
        tags.map((tag) => {
          const count = tagCounts[tag];
          return (
            <a
              href={`/tags/${tag}/1`}
              class="group bg-foreground/5 hover:bg-accent hover:text-background border-foreground/10 hover:border-accent animation relative flex items-center gap-2 rounded-full border px-4 py-2 no-underline"
            >
              <span class="text-lg font-medium tracking-wide">{tag}</span>
              <span class="bg-accent/20 group-hover:bg-background/20 flex h-6 min-w-[1.5rem] items-center justify-center rounded-full px-2 font-mono text-sm">
                {count}
              </span>
            </a>
          );
        })
      }
    </div>
  </div>
</BaseLayout>
